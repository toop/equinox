<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

    <!-- 规则分类 -->
    <record id="hr_payroll.PIT" model="hr.salary.rule.category">
        <field name="name">个人所得税</field>
        <field name="code">PIT</field>
    </record>

    <record id="hr_payroll.COMP" model="hr.salary.rule.category">
        <field name="name">公司缴纳部分</field>
        <field name="code">COMP</field>
    </record>

    <!-- 薪酬规则 -->

    <record id="hr_payroll_rules_pit" model="hr.salary.rule">
        <field name="category_id" ref="hr_payroll.BT"/>
        <field name="name">税前收入</field>
        <field name="code">BT</field>
        <field name="appears_on_payslip" eval="True"/>
        <field name="sequence">90</field>
        <field name="condition_select">none</field>
        <field name="amount_select">code</field>
        <field name="amount_python_compute">result = categories.BASIC + categories.ALW + categories.DED</field>
    </record>

    <!-- 个人所得税母规则-->
    <record id="hr_payroll_rules_pit" model="hr.salary.rule">
        <field name="category_id" ref="hr_payroll.PIT"/>
        <field name="name">个人所得税</field>
        <field name="code">PIT</field>
        <field name="amount_select">fix</field>
        <field name="sequence">100</field>
        <field name="condition_select">none</field>
        <field name="appears_on_payslip" eval="False"/>
    </record>

    <record id="hr_payroll_rules_pit1" model="hr.salary.rule">
        <field name="category_id" ref="hr_payroll.PIT"/>
        <field name="parent_rule_id" ref="hr_payroll_rules_pit"/>
        <field name="name">个人所得税</field>
        <field name="code">PIT1</field>
        <field name="sequence">110</field>
        <field name="appears_on_payslip" eval="True"/>
        <field name="condition_select">python</field>
        <field name="condition_python">BT - contract.pit_exemption_amount></field>
        <field name="amount_select">code</field>
        <field name="amount_python_compute">result = -((BT - contract.pit_exemption_amount) * 0.03)</field>
    </record>

    <record id="hr_payroll_rules_insurance" model="hr.salary.rule">
        <field name="category_id" ref="hr_payroll.DED"/>
        <field name="name">Insurance</field>
        <field name="code">Ins</field>
        <field name="amount_select">code</field>
        <field name="sequence">165</field>
        <field name="condition_select">python</field>
        <field name="condition_python">result = bool(contract.insurance_employee_deduction)</field>
        <field name="amount_python_compute">result = -contract.insurance_employee_deduction</field>
    </record>

    <!-- 薪酬结构 -->

    <record id="hr_payroll_salary_structure_employee" model="hr.payroll.structure">
        <field name="code">NEP01</field>
        <field name="name">中国法定薪酬（含公积金）</field>
        <field eval="[(6, 0, [ref('hr_payroll_rules_insurance'))])]" name="rule_ids"/>
        <field name="company_id" ref="base.main_company"/>    
        <field name="parent_id" ref="hr_payroll.structure_base"/>
    </record>

    </data>
</openerp>
